clc; close all; clear all; format long G

c = physconst("LightSpeed");
tR_sec = [ 142874.031415926, 142874.031415926, 142874.031415926, 142874.031415926 ];
tS_sec = [ 142873.929, 142873.930, 142873.926, 142873.928 ];

rSvECEF = [ -7771062.621964, -13392926.713787, 21699866.518681;
            4747181.126449,  -25802711.537558, 3938318.400306;
            14684443.702457, -15351446.405048, 15470725.361304;
            -15730896.676495, -20849558.582301, 5362760.419279;
          ];

dtIono = [
    1.105596e-08;
    1.206681e-08;
    1.582324e-08;
    1.226210e-08;
];

dtTropo = [
    1.031992e-08;
    1.008367e-08;
    1.408656e-08;
    1.102516e-08;
];

dtS = [ 
    0.000124682;
    0.000324047;
    -0.000394024;
    -0.000018238;
];

pseudorange = c*(tR_sec - tS_sec);
INFO.rSvECEF = rSvECEF;
INFO.dtIono = dtIono;
INFO.dtTropo = dtTropo; 
INFO.dtS = dtS;

[rRX, c_dtR] = nonlinearLS(pseudorange, INFO);

rRX
dtR = c_dtR/c
