clc; close all; clear all;

c = physconst("LightSpeed");
tR_sec = [ 429615.504253994, 429615.504514099, 429615.505066282, 429615.505190982 ];
tS_sec = [ 429615.436, 429615.446, 429615.440, 429615.438 ];

rSvECEF = [ -15206930.706156, -20832520.6664809, -6469517.7047024;
             644129.213511344, -22105331.2073303, 14614081.7413721;
             -18139647.3560073, -12028727.5758169, 15453336.7251709;
             17478991.6859777, -16545561.3989088, 11624502.8670108
          ];

dtIono = [
    2.33838930420718e-08;
    1.07933295823888e-08;
    1.69238352966293e-08;
    1.71386691737267e-08;
];

dtTropo = [
    1.90304034510942e-08;
    8.36092156790743e-09;
    1.31971700978366e-08;
    1.61167561114859e-08;
];

dtS = [ 
    0.000116168688750703;
    -0.000109838783947257;
    0.000156846547048633;
    0.000217636932174885;
];

pseudorange = c*(tR_sec - tS_sec);
INFO.rSvECEF = rSvECEF;
INFO.dtIono = dtIono;
INFO.dtTropo = dtTropo; 
INFO.dtS = dtS;

[rRX, c_dtR] = nonlinearLS(pseudorange, INFO)
